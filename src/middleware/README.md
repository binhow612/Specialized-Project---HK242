Middleware (authentication, validation, error handling)